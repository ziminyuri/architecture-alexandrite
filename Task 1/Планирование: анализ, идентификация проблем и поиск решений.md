## Анализ проблем
### Существующие проблемы с точки зрения пользователя

1. Долгая загрузка страницы MES.
2. Зависание заказов в статусах или их потеря.

### Недостатки текущей архитектуры
1. API не закрыты gateway. Возможно имеет смысл выделить 2 gateway:
   1. Клиентский. Маршрутизация клиентских запросов со своего сайта. Закрыть им Shop API. Сделать авторизацию по токену на уровне пользователя.
   2. Системный. Закрыть им MES API. Использовать gateway для b2b интеграций с партнерами. Авторизация по API-KEY или по токену на уровне компании.
2. Указано, что аутентификация и авторизация реализована во всех приложениях. Возможно имеет смысл сделать один сервис авторизации/аутентификации (SSO) и выполнять эти функции через гетвей и SSO, а не на уровне сервисов.
3. Необходимо настроить репликацию SHOP DB и MES DB. Поддержать появление репликации на уровне API в методах на чтение.
4. Необходимо добавить кеширование для MES.
   1. Серверное. Поднимаем key-value хранилище. Пропускаем запросы на чтение через кеш. 
   2. Клиентское. Начинаем кешировать на стороне браузера статику. 
7. Необходимо выделить из SHOP DB таблицы, за которые отвечает домен CRM API. Необходимо сделать, чтобы 2 сервиса не писали в общую БД и компоненты не были связаны.
8. В качестве оркестратора прикладных приложений стоит рассмотреть внедрение K8S вместо использования EC2. Таким образом можно упростить дальнейшее горизонтальное масштабирование и повышение отказоустойчивости приложений.
9. Необходимо поднять Prometheus и Grafana, а также настроить сбор метрик и их графическое представление для мониторинга системы. Настроить алертинг для ЛТП.
10. Добавить трассировку запросов (Jaeger)
11. Добавить логирование. 
    1. В первую очередь логируем ошибки валидации и изменение сущностей. 
    2. Настроить сбор логов.
14. Выполнить выделение логических блоков у MES.
    1. Расчет изделия
    2. Управление заказами
17. Создать приложение по управлению файлами в S3. Сейчас в S3 пишут 3 сервиса.
18. Настроить CICD.
19. Поднять репозиторий со спецификацией и документацией. 
20. Необходимо открыть найм персонала, чтобы повысить bus factor. 

### План работ
#### 1 квартал
1. Необходимо добавить кеширование для MES. - Можем довольно быстро ускорить быстродействие страниц
2. Покрыть метриками код, настроить дашборды. - Можем в реалтайме наблюдать какой компонент деградирует, чтобы потом начать точечно решать проблемы.
3. Начать работы по внедрению гетвеев. - Базовая вещь. Блокирует выделение авторизации через гетвей, настройки Rate limit, логированию и т.д.

#### 2 квартал
1. Завершение внедрение гетвеев. 
2. Анализ проблем, выявленных после добавления метрик. Возможно начать фиксить баги в текущем квартале, зависит от характера проблемы.
3. Выделение сервисов у MES.
4. Настройка CICD.